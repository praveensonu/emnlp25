2025-04-09 13:15:57,624 - INFO - --- Starting Semantic Score Calculation ---
2025-04-09 13:15:57,625 - INFO - Selected model type: gte
2025-04-09 13:15:57,625 - INFO - Output file: semantic_scores_gte.csv
2025-04-09 13:15:57,625 - INFO - Using CUDA devices: 7
2025-04-09 13:15:57,626 - INFO - Loading domain QA data from: /home/praveen/theoden/emnlp_25/dataset/domain_qa.csv
2025-04-09 13:15:58,366 - INFO - Loaded domain data with shape: (1409, 7)
2025-04-09 13:15:58,366 - INFO - Loading forget data from Hugging Face: hf://datasets/Shiyu-Lab/Wikipedia_Person_Unlearn/forget_20_1/train-00000-of-00001.parquet
2025-04-09 13:16:00,008 - INFO - Loaded forget data with shape: (98, 5)
2025-04-09 13:16:00,009 - INFO - Merging dataframes on 'title' column...
2025-04-09 13:16:00,015 - INFO - Merged dataframe shape before preprocessing: (7029, 11)
2025-04-09 13:16:00,015 - INFO - Starting data preprocessing...
2025-04-09 13:16:00,015 - INFO - Dropping duplicates based on subset: ['title', 'SimilarName', 'wikipage', 'content']
2025-04-09 13:16:00,205 - INFO - Shape after dropping duplicates: (120, 11)
2025-04-09 13:16:00,205 - INFO - Selecting columns: ['title', 'SimilarName', 'wikipage', 'content']
2025-04-09 13:16:00,206 - INFO - Dropping rows with NaN in 'wikipage' or 'content'
2025-04-09 13:16:00,207 - INFO - Shape after dropping NaN values: (120, 4)
2025-04-09 13:16:00,208 - INFO - Ensured 'wikipage' and 'content' are string type.
2025-04-09 13:16:00,208 - INFO - Loading Sentence Transformer model: Alibaba-NLP/gte-Qwen2-1.5B-instruct
2025-04-09 13:16:00,208 - INFO - Trust remote code: True
2025-04-09 13:16:00,208 - INFO - Setting max_seq_length: 16700
2025-04-09 13:16:00,501 - INFO - Use pytorch device_name: cuda
2025-04-09 13:16:00,501 - INFO - Load pretrained SentenceTransformer: Alibaba-NLP/gte-Qwen2-1.5B-instruct
A new version of the following files was downloaded from https://huggingface.co/Alibaba-NLP/gte-Qwen2-1.5B-instruct:
- modeling_qwen.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files:  50%|█████     | 1/2 [01:06<01:06, 66.17s/it]Fetching 2 files: 100%|██████████| 2/2 [01:06<00:00, 33.09s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.60it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.60it/s]
A new version of the following files was downloaded from https://huggingface.co/Alibaba-NLP/gte-Qwen2-1.5B-instruct:
- tokenization_qwen.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
2025-04-09 13:17:36,775 - INFO - 1 prompts are loaded, with the keys: ['query']
2025-04-09 13:17:36,776 - INFO - Model loaded successfully.
2025-04-09 13:17:36,777 - INFO - Computing semantic similarity scores...
Calculating Scores (gte):   0%|          | 0/120 [00:00<?, ?it/s]Calculating Scores (gte):   2%|▏         | 2/120 [00:01<01:09,  1.69it/s]Calculating Scores (gte):   2%|▎         | 3/120 [00:02<01:50,  1.06it/s]Calculating Scores (gte):   3%|▎         | 4/120 [00:02<01:22,  1.40it/s]Calculating Scores (gte):   4%|▍         | 5/120 [00:04<01:49,  1.05it/s]Calculating Scores (gte):   5%|▌         | 6/120 [00:05<01:41,  1.13it/s]Calculating Scores (gte):   6%|▌         | 7/120 [00:06<01:41,  1.11it/s]Calculating Scores (gte):   7%|▋         | 8/120 [00:06<01:35,  1.17it/s]Calculating Scores (gte):   8%|▊         | 9/120 [00:07<01:23,  1.32it/s]Calculating Scores (gte):   8%|▊         | 10/120 [00:07<01:05,  1.68it/s]Calculating Scores (gte):   9%|▉         | 11/120 [00:08<01:00,  1.82it/s]Calculating Scores (gte):  10%|█         | 12/120 [00:08<00:50,  2.13it/s]Calculating Scores (gte):  11%|█         | 13/120 [00:08<00:41,  2.60it/s]Calculating Scores (gte):  12%|█▏        | 14/120 [00:09<00:56,  1.87it/s]Calculating Scores (gte):  12%|█▎        | 15/120 [00:10<01:23,  1.26it/s]Calculating Scores (gte):  13%|█▎        | 16/120 [00:11<01:13,  1.42it/s]Calculating Scores (gte):  14%|█▍        | 17/120 [00:11<01:05,  1.58it/s]Calculating Scores (gte):  15%|█▌        | 18/120 [00:12<01:05,  1.57it/s]Calculating Scores (gte):  16%|█▌        | 19/120 [00:13<01:15,  1.33it/s]Calculating Scores (gte):  17%|█▋        | 20/120 [00:14<01:15,  1.32it/s]Calculating Scores (gte):  18%|█▊        | 21/120 [00:15<01:35,  1.04it/s]Calculating Scores (gte):  18%|█▊        | 22/120 [00:16<01:41,  1.04s/it]Calculating Scores (gte):  19%|█▉        | 23/120 [00:17<01:40,  1.03s/it]Calculating Scores (gte):  20%|██        | 24/120 [00:18<01:19,  1.21it/s]Calculating Scores (gte):  21%|██        | 25/120 [00:18<01:04,  1.47it/s]Calculating Scores (gte):  22%|██▏       | 26/120 [00:22<02:22,  1.52s/it]Calculating Scores (gte):  22%|██▎       | 27/120 [00:22<01:54,  1.23s/it]Calculating Scores (gte):  23%|██▎       | 28/120 [00:26<03:02,  1.98s/it]Calculating Scores (gte):  24%|██▍       | 29/120 [00:30<03:48,  2.51s/it]Calculating Scores (gte):  25%|██▌       | 30/120 [00:31<03:08,  2.09s/it]Calculating Scores (gte):  26%|██▌       | 31/120 [00:32<02:41,  1.81s/it]Calculating Scores (gte):  27%|██▋       | 32/120 [00:32<02:06,  1.44s/it]Calculating Scores (gte):  28%|██▊       | 33/120 [00:33<01:40,  1.16s/it]Calculating Scores (gte):  28%|██▊       | 34/120 [00:35<02:08,  1.50s/it]Calculating Scores (gte):  29%|██▉       | 35/120 [00:36<01:39,  1.17s/it]Calculating Scores (gte):  30%|███       | 36/120 [00:37<01:53,  1.35s/it]Calculating Scores (gte):  31%|███       | 37/120 [00:41<02:39,  1.92s/it]Calculating Scores (gte):  32%|███▏      | 38/120 [00:41<02:10,  1.59s/it]Calculating Scores (gte):  32%|███▎      | 39/120 [00:42<01:37,  1.20s/it]Calculating Scores (gte):  33%|███▎      | 40/120 [00:42<01:24,  1.06s/it]Calculating Scores (gte):  34%|███▍      | 41/120 [00:43<01:06,  1.20it/s]Calculating Scores (gte):  35%|███▌      | 42/120 [00:43<00:51,  1.52it/s]Calculating Scores (gte):  36%|███▌      | 43/120 [00:44<00:47,  1.63it/s]Calculating Scores (gte):  37%|███▋      | 44/120 [00:44<00:41,  1.81it/s]Calculating Scores (gte):  38%|███▊      | 45/120 [00:45<00:45,  1.64it/s]Calculating Scores (gte):  38%|███▊      | 46/120 [00:46<00:53,  1.38it/s]Calculating Scores (gte):  39%|███▉      | 47/120 [00:46<00:51,  1.43it/s]Calculating Scores (gte):  40%|████      | 48/120 [00:47<00:43,  1.65it/s]Calculating Scores (gte):  41%|████      | 49/120 [00:47<00:38,  1.85it/s]Calculating Scores (gte):  42%|████▏     | 50/120 [00:47<00:34,  2.04it/s]Calculating Scores (gte):  42%|████▎     | 51/120 [00:49<00:49,  1.38it/s]Calculating Scores (gte):  43%|████▎     | 52/120 [00:49<00:43,  1.55it/s]Calculating Scores (gte):  44%|████▍     | 53/120 [00:50<00:48,  1.38it/s]Calculating Scores (gte):  45%|████▌     | 54/120 [00:52<01:19,  1.20s/it]Calculating Scores (gte):  46%|████▌     | 55/120 [00:53<01:12,  1.11s/it]Calculating Scores (gte):  47%|████▋     | 56/120 [00:54<01:00,  1.06it/s]Calculating Scores (gte):  48%|████▊     | 57/120 [00:54<00:53,  1.18it/s]Calculating Scores (gte):  48%|████▊     | 58/120 [00:55<00:45,  1.37it/s]Calculating Scores (gte):  49%|████▉     | 59/120 [00:55<00:38,  1.60it/s]Calculating Scores (gte):  50%|█████     | 60/120 [00:57<00:50,  1.18it/s]Calculating Scores (gte):  51%|█████     | 61/120 [00:58<00:59,  1.00s/it]Calculating Scores (gte):  52%|█████▏    | 62/120 [00:58<00:46,  1.26it/s]Calculating Scores (gte):  52%|█████▎    | 63/120 [00:59<00:40,  1.41it/s]Calculating Scores (gte):  53%|█████▎    | 64/120 [00:59<00:34,  1.62it/s]Calculating Scores (gte):  54%|█████▍    | 65/120 [01:00<00:28,  1.92it/s]Calculating Scores (gte):  55%|█████▌    | 66/120 [01:00<00:24,  2.18it/s]Calculating Scores (gte):  56%|█████▌    | 67/120 [01:00<00:24,  2.19it/s]Calculating Scores (gte):  57%|█████▋    | 68/120 [01:01<00:22,  2.27it/s]Calculating Scores (gte):  57%|█████▊    | 69/120 [01:01<00:19,  2.55it/s]Calculating Scores (gte):  58%|█████▊    | 70/120 [01:01<00:19,  2.58it/s]Calculating Scores (gte):  59%|█████▉    | 71/120 [01:02<00:20,  2.41it/s]Calculating Scores (gte):  60%|██████    | 72/120 [01:02<00:20,  2.38it/s]Calculating Scores (gte):  61%|██████    | 73/120 [01:03<00:21,  2.21it/s]Calculating Scores (gte):  62%|██████▏   | 74/120 [01:07<01:10,  1.52s/it]Calculating Scores (gte):  62%|██████▎   | 75/120 [01:11<01:42,  2.27s/it]Calculating Scores (gte):  63%|██████▎   | 76/120 [01:13<01:43,  2.35s/it]Calculating Scores (gte):  64%|██████▍   | 77/120 [01:16<01:48,  2.52s/it]Calculating Scores (gte):  65%|██████▌   | 78/120 [01:17<01:24,  2.02s/it]Calculating Scores (gte):  66%|██████▌   | 79/120 [01:18<01:05,  1.59s/it]Calculating Scores (gte):  67%|██████▋   | 80/120 [01:18<00:48,  1.22s/it]Calculating Scores (gte):  68%|██████▊   | 81/120 [01:19<00:43,  1.11s/it]Calculating Scores (gte):  68%|██████▊   | 82/120 [01:19<00:34,  1.11it/s]Calculating Scores (gte):  69%|██████▉   | 83/120 [01:20<00:29,  1.27it/s]Calculating Scores (gte):  70%|███████   | 84/120 [01:20<00:24,  1.46it/s]Calculating Scores (gte):  71%|███████   | 85/120 [01:21<00:20,  1.70it/s]Calculating Scores (gte):  72%|███████▏  | 86/120 [01:22<00:22,  1.50it/s]Calculating Scores (gte):  72%|███████▎  | 87/120 [01:23<00:30,  1.09it/s]Calculating Scores (gte):  73%|███████▎  | 88/120 [01:25<00:38,  1.22s/it]Calculating Scores (gte):  74%|███████▍  | 89/120 [01:25<00:29,  1.04it/s]Calculating Scores (gte):  75%|███████▌  | 90/120 [01:26<00:23,  1.28it/s]Calculating Scores (gte):  76%|███████▌  | 91/120 [01:26<00:20,  1.45it/s]Calculating Scores (gte):  77%|███████▋  | 92/120 [01:27<00:21,  1.33it/s]Calculating Scores (gte):  78%|███████▊  | 93/120 [01:28<00:19,  1.40it/s]Calculating Scores (gte):  78%|███████▊  | 94/120 [01:29<00:22,  1.14it/s]Calculating Scores (gte):  79%|███████▉  | 95/120 [01:29<00:17,  1.40it/s]Calculating Scores (gte):  80%|████████  | 96/120 [01:30<00:15,  1.59it/s]Calculating Scores (gte):  81%|████████  | 97/120 [01:30<00:13,  1.66it/s]Calculating Scores (gte):  82%|████████▏ | 98/120 [01:31<00:13,  1.66it/s]Calculating Scores (gte):  82%|████████▎ | 99/120 [01:32<00:14,  1.42it/s]Calculating Scores (gte):  83%|████████▎ | 100/120 [01:32<00:13,  1.50it/s]Calculating Scores (gte):  84%|████████▍ | 101/120 [01:33<00:11,  1.60it/s]Calculating Scores (gte):  85%|████████▌ | 102/120 [01:34<00:13,  1.33it/s]Calculating Scores (gte):  86%|████████▌ | 103/120 [01:34<00:11,  1.50it/s]Calculating Scores (gte):  87%|████████▋ | 104/120 [01:36<00:16,  1.05s/it]Calculating Scores (gte):  88%|████████▊ | 105/120 [01:37<00:13,  1.15it/s]Calculating Scores (gte):  88%|████████▊ | 106/120 [01:38<00:11,  1.22it/s]Calculating Scores (gte):  89%|████████▉ | 107/120 [01:38<00:10,  1.29it/s]Calculating Scores (gte):  90%|█████████ | 108/120 [01:39<00:08,  1.49it/s]Calculating Scores (gte):  91%|█████████ | 109/120 [01:39<00:06,  1.74it/s]Calculating Scores (gte):  92%|█████████▏| 110/120 [01:40<00:06,  1.59it/s]Calculating Scores (gte):  92%|█████████▎| 111/120 [01:41<00:06,  1.29it/s]Calculating Scores (gte):  93%|█████████▎| 112/120 [01:41<00:05,  1.49it/s]Calculating Scores (gte):  94%|█████████▍| 113/120 [01:42<00:04,  1.42it/s]Calculating Scores (gte):  95%|█████████▌| 114/120 [01:43<00:04,  1.37it/s]Calculating Scores (gte):  96%|█████████▌| 115/120 [01:43<00:03,  1.49it/s]Calculating Scores (gte):  97%|█████████▋| 116/120 [01:45<00:03,  1.13it/s]Calculating Scores (gte):  98%|█████████▊| 117/120 [01:45<00:02,  1.31it/s]Calculating Scores (gte):  98%|█████████▊| 118/120 [01:46<00:01,  1.53it/s]Calculating Scores (gte):  99%|█████████▉| 119/120 [01:46<00:00,  1.60it/s]Calculating Scores (gte): 100%|██████████| 120/120 [01:47<00:00,  1.23it/s]Calculating Scores (gte): 100%|██████████| 120/120 [01:48<00:00,  1.10it/s]
2025-04-09 13:19:25,546 - INFO - Finished computing scores.
2025-04-09 13:19:25,546 - INFO - Saving results to: semantic_scores_gte.csv
2025-04-09 13:19:25,618 - INFO - Results saved successfully.
2025-04-09 13:19:25,618 - INFO - --- Script Finished ---
